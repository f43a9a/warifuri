# Auto-merge configuration for warifuri tasks
# This file enables automatic PR creation and merging for machine tasks

# When to enable auto-merge
enabled: true

# Conditions for auto-merge (all must be met)
conditions:
  # Task type must be machine (human/ai tasks require manual review)
  task_type: "machine"

  # All validation checks must pass
  validation_required: true

  # No manual review required for this task
  manual_review: false

  # Maximum runtime before considering task failed (minutes)
  timeout_minutes: 30

# PR creation settings
pull_request:
  # Labels to add to auto-created PRs
  labels:
    - "warifuri"
    - "automation"
    - "auto-merge"

  # Template for PR title
  title_template: "Complete warifuri task: {task_name}"

  # Delete branch after merge
  delete_branch: true

  # Merge strategy
  merge_strategy: "squash"  # options: merge, squash, rebase

# Notification settings
notifications:
  # Slack webhook URL (optional)
  slack_webhook: ""

  # Email notifications (optional)
  email: []

  # GitHub mentions (optional)
  github_mentions: []

# Safety settings
safety:
  # Require specific file patterns to be present
  required_files: []

  # Forbidden file patterns (will block auto-merge)
  forbidden_files:
    - "*.key"
    - "*.pem"
    - ".env"
    - "secrets.*"

  # Maximum number of files that can be changed
  max_files_changed: 50

  # Maximum diff size (lines)
  max_diff_lines: 1000

# Custom validation commands (optional)
custom_validation:
  # Commands to run before auto-merge
  pre_merge_commands: []

  # Commands to run after successful merge
  post_merge_commands: []

# Rollback settings
rollback:
  # Enable automatic rollback on failure
  enabled: false

  # Conditions that trigger rollback
  triggers:
    - "test_failure"
    - "validation_failure"
    - "timeout"
